# RSA-Warmup
**Category:** Crypto

**Points:** 20

**Description:**
> RSA is one of the first public-key cryptosystems and is widely used for secure
data transmission. In such a cryptosystem, the encryption key is public and distinct
from the decryption key which is kept secret.
> You all know this :p
> here is a warmup question.
>
> nc crypto.zh3r0.ml 8451
>
> Author : Finch


## Writeup
Right away, I connect to *crypto.zh3r0.ml* on *8451*:
```
$ nc crypto.zh3r0.ml 8451
N: 377527856297171022669430056458716981263384258911465530298564047397682287642100531751631168955623627172831784659749005505789640040456392136544756565404399136372321247852095482514289004599548556755136227142622582929120287466843804001721473294727815058414197945673495141542166225440016738784813546536980135143334440970683
e 65537
CT: 95948178426011852526092427535011433312244071609714551743388577712830026414291835888189885830916269208524310224012724690007902199693329646995676301990765789834069875091787078165512725155603953938812696365285032576235285424419104188074925160749412987648492099796143791507498570035439690972646885220025246628999734089438
```

Looks like we get the public key information and the ciphertext. Simple enough.
Our goal here is to retrieve the private key from this information. Well, the
value we really want the private exponent - **d**.

A tool I always like to use for RSA challenges is **RsaCtfTool** (you can find a
link under *Resources*). We can pass in our modulus (**n**) and public exponent - **e**
and have it run through the attacks. The *--private* option indicates we want to
extract the private key and the *--dumpkey* option dumps the information we want
found from the private key extracted. That is, assuming we successfully
extract the private key.

Here is the command I used:
```
$ ~/tools/RsaCtfTool/RsaCtfTool.py -n 377527856297171022669430056458716981263384258911465530298564047397682287642100531751631168955623627172831784659749005505789640040456392136544756565404399136372321247852095482514289004599548556755136227142622582929120287466843804001721473294727815058414197945673495141542166225440016738784813546536980135143334440970683 -e 65537 --private --dumpkey
```

**Output:**
```
[*] Testing key /tmp/tmp6ccy5el8.
[*] Performing boneh_durfee attack on /tmp/tmp6ccy5el8.
[*] Performing comfact_cn attack on /tmp/tmp6ccy5el8.
[*] Performing cube_root attack on /tmp/tmp6ccy5el8.
[*] Performing ecm attack on /tmp/tmp6ccy5el8.
[*] ECM Method can run forever and may never succeed, timeout set to 30sec. Hit Ctrl-C to bail out.
[*] Performing ecm2 attack on /tmp/tmp6ccy5el8.
[*] ECM2 Method can run forever and may never succeed, timeout set to 30sec. Hit Ctrl-C to bail out.
[*] Performing factordb attack on /tmp/tmp6ccy5el8.

Results for /tmp/tmp6ccy5el8:

Private key :
-----BEGIN RSA PRIVATE KEY-----
MIICMAIBAAKBhH0sgDnDQ1mkNuUnZO/mpoyDR4g75cI6VYtbA4pXLtfgJVnD4lep
6qT//hwsoqi2fgAZ3dyqj+shvwZ3q/w0OA1P6dGPVREz65H3WRxlkqXhbm8LIz2O
RG8+aiXtGuKOcP7U4gN/vdUv/Ma+loHW9nH4EXb3MUtVex8YHlDCGoOinu2puwID
AQABAoGESKHl1Uc9GEbSh7BtlDlcsY3sf+/hK0HBF7iUhMLWreXpJgNHjr3Odzx5
WQZBXzpwOsqreCqYpF+KeW+GUVYuUy8+wNOrHDNd7h7tvkewyp6b4lSani14jhtX
yyfcuUIxW+dEXWQmZScR2hHCmv+7moyKhErMn6DC8vy/Rqjoio9PXf8hAgUA1L0y
zwKBgQCWoNGhjoAaFWOI78WpjnlCfL9F6R/LtDPvODWGiZozKkCT4bl41uS7tk5f
TfQSZHsDXRz5M3rxRzdw8VupI1y7YtrfkZ9KH80PAdDxFhrrKxWmBqOCxVW5kQkR
8BRJ4ZQRxV0blUJfEkm0/VLCUE7VsESlhOXZLG3ySESDznZFVQIECkYc1wKBgGAP
cYFJgpKf31leKD2I2fY33je0g42Cf7horWH+cTN+F673vjO9QCQiEHshGK1+HSE5
CZg3Z4ll9Ip3sg/8uE/crF713JMGEt0mOFz3zvT5BhZal353YMM2JoWlCRtQ3AA1
ULqdhrVg0Va2U0gOtSf8ANtaFMdaWUexJNi2G6D9AgRh9WJR
-----END RSA PRIVATE KEY-----
n: 377527856297171022669430056458716981263384258911465530298564047397682287642100531751631168955623627172831784659749005505789640040456392136544756565404399136372321247852095482514289004599548556755136227142622582929120287466843804001721473294727815058414197945673495141542166225440016738784813546536980135143334440970683
e: 65537
d: 219061435757608963852907672365350121299489108161668187742617152085491396400767315113244112175489996960042494385717319659862230149219931086843159575463511365277827147675298287172908252862749761614617624713298567307138000590141729337640164470545650707611179689947921461153334557400166620309314271542064731256728948965153
p: 3569169103
q: 105774718261414643504894773952859969398705247872775147212901346074910894364004173593125259370940942265808856706263212742427923018041544482277436257803557237722821688298161725545534905578708456267597648522685472470627370962883683799983145067231020199273028937702729839399869484256268016557693917294055466091861
```

Nice! Looks like we extracted our private exponent. Here is a small python
snippet to get the plaintext.
```
from pwn import *
from Crypto.Util.number import long_to_bytes

n = 377527856297171022669430056458716981263384258911465530298564047397682287642100531751631168955623627172831784659749005505789640040456392136544756565404399136372321247852095482514289004599548556755136227142622582929120287466843804001721473294727815058414197945673495141542166225440016738784813546536980135143334440970683
d = 219061435757608963852907672365350121299489108161668187742617152085491396400767315113244112175489996960042494385717319659862230149219931086843159575463511365277827147675298287172908252862749761614617624713298567307138000590141729337640164470545650707611179689947921461153334557400166620309314271542064731256728948965153
c = 95948178426011852526092427535011433312244071609714551743388577712830026414291835888189885830916269208524310224012724690007902199693329646995676301990765789834069875091787078165512725155603953938812696365285032576235285424419104188074925160749412987648492099796143791507498570035439690972646885220025246628999734089438

m = pow(c,d,n)
flag = long_to_bytes(m).decode("utf-8")
log.success("Flag: {}".format(flag))
```

I use log.success() from *pwntools* cause it satisfies me to see the green plus
so no hate.

**Output:**
```
$ python3 rsa_warmup.py
[+] Flag: zh3r0{RSA_1s_Fun}
```

## Flag
zh3r0{RSA_1s_Fun}

## Resources
RsaCtfTool - https://github.com/Ganapati/RsaCtfTool

RSA - https://en.wikipedia.org/wiki/RSA_(cryptosystem)
